--PROCEDIMIENTOS
--PROCEDIMIENTO QUE INSERTA USUARIOS_EMPRESAS
CREATE OR REPLACE PROCEDURE INSERTAR_USUARIO_EMPRESA (nom in VARCHAR2, perfil in NUMERIC, rut in VARCHAR2, emp in VARCHAR2, correo in VARCHAR2)
IS
user_id USUARIO.ID%TYPE;
BEGIN
INSERT INTO USUARIO (ID, USERNAME, PASSWORD, PERFIL_ID) 
VALUES (round(dbms_random.value(10000,99999)), nom, round(dbms_random.value(1000,9999)), perfil)
RETURNING ID INTO user_id;
INSERT INTO EMPRESA (ID, RUT, NOMBRE, CORREO, USUARIO_ID) VALUES (round(dbms_random.value(10000,99999)), rut, emp, correo, user_id);
END;


--PROCEDIMIENTO QUE INSERTA USUARIOS_EMPLEADO
CREATE OR REPLACE PROCEDURE INSERTAR_USUARIO_EMPLEADO (userN in VARCHAR2, perfil in NUMERIC, rut in VARCHAR2, nom in VARCHAR2, ape in VARCHAR2, cargo in NUMERIC)
IS
user_id USUARIO.ID%TYPE;
BEGIN
INSERT INTO USUARIO (ID, USERNAME, PASSWORD, PERFIL_ID) 
VALUES (round(dbms_random.value(10000,99999)), userN, round(dbms_random.value(1000,9999)), perfil)
RETURNING ID INTO user_id;
INSERT INTO EMPLEADO (ID, NOMBRE, APELLIDO, RUT, CARGO_ID, USUARIO_ID) VALUES (round(dbms_random.value(10000,99999)), nom, ape, rut, cargo, user_id);
END;


--PROCEDIMIENTO QUE INSERTA USUARIOS_PROVEEDOR
CREATE OR REPLACE PROCEDURE INSERTAR_USUARIO_PROVEEDOR (userN in VARCHAR2, perfil in NUMERIC, rut in VARCHAR2, nom in VARCHAR2, tel in VARCHAR2, correo in VARCHAR2, rubro in NUMERIC)
IS
user_id USUARIO.ID%TYPE;
BEGIN
INSERT INTO USUARIO (ID, USERNAME, PASSWORD, PERFIL_ID) 
VALUES (round(dbms_random.value(10000,99999)), userN, round(dbms_random.value(1000,9999)), perfil)
RETURNING ID INTO user_id;
INSERT INTO PROVEEDOR (ID, NOMBRE, RUT, TELEFONO,  CORREO, RUBRO_ID, USUARIO_ID) VALUES (round(dbms_random.value(10000,99999)), nom, rut, tel, correo, rubro, user_id);
END;

--PROCEDIMIENTO QUE LISTA LOS USUARIOS Y SU PERFIL
CREATE OR REPLACE PROCEDURE seleccionaUsuarios (registros out sys_refcursor)
AS BEGIN
    OPEN registros for 
    SELECT USUARIO.ID, USUARIO.USERNAME, PERFIL.NOMBRE
    FROM USUARIO, PERFIL
    WHERE USUARIO.PERFIL_ID = PERFIL.ID;
END;

--PROCEDIMIENTO QUE INSERTA UNA HABITACION
create or replace PROCEDURE INSERTAR_RESERVA_HABITACION (HUESPED_ID in NUMERIC , SERVICIO_ID in NUMERIC, ARCHIVO in VARCHAR2, TOTAL in NUMERIC, HABITACION_ID in NUMERIC, TIPO_SERVICIO_ID in NUMERIC)
IS
BEGIN
Insert into ORDEN_COMPRA (ID,HUESPED_ID,SERVICIO_ID,ARCHIVO,TOTAL,HABITACION_ID,TIPO_SERVICIO_ID)
values (round(dbms_random.value(10000,99999)) ,HUESPED_ID,SERVICIO_ID,ARCHIVO,TOTAL,HABITACION_ID,TIPO_SERVICIO_ID);
END;

--PROCEDIMIENTO QUE RESERVA UNA HABITACION
create or replace PROCEDURE INSERTAR_RESERVA_HABITACION (HUESPED_ID in NUMERIC , SERVICIO_ID in NUMERIC, ARCHIVO in VARCHAR2, TOTAL in NUMERIC, HABITACION_ID in NUMERIC, TIPO_SERVICIO_ID in NUMERIC)
IS
BEGIN
Insert into ORDEN_COMPRA (ID,HUESPED_ID,SERVICIO_ID,ARCHIVO,TOTAL,HABITACION_ID,TIPO_SERVICIO_ID)
values (round(dbms_random.value(10000,99999)) ,HUESPED_ID,SERVICIO_ID,ARCHIVO,TOTAL,HABITACION_ID,TIPO_SERVICIO_ID);
END;

--SECUENCIAS

--TRIGGERS

